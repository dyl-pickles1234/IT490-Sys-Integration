<html>
<script>

	function HandleLoginResponse(response) {
		var responseObj = JSON.parse(response);
		console.log(responseObj);
		var res = responseObj[1];
		var success;

		if (res === false) {
			success = false;
		} else {
			success = res[1];
		}

		//	document.getElementById("textResponse").innerHTML = response+"<p>";	
		// document.getElementById("textResponse").innerHTML = "response: " + responseObj[0] + "<p>";
		document.getElementById("textResponse").innerHTML = success ? "Login successful!" : "Login failed!";

		if (success) {
			// set cookie
			document.cookie = "session_id=" + res[2] + "; path=/";
			window.location.href = "home.php";
		}
	}

	function SendLoginRequest(email, password) {
		var request = new XMLHttpRequest();
		request.open("POST", "webserver.php", true);
		request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
		request.onreadystatechange = function () {

			if ((this.readyState == 4) && (this.status == 200)) {
				HandleLoginResponse(this.responseText);
			}
		}
		request.send("type=login&email=" + email + "&pword=" + password);
	}

	function GetLoginInfo() {
		email = document.getElementById("email_input").value;
		password = document.getElementById("password_input").value;
		// document.getElementById("textResponse").innerHTML = email + ' ' + password
		SendLoginRequest(email, password);
	}

</script>

<h1>Login!</h1>

<body>
	<div id="textResponse"></div>
	<p>Email: <input type="email" id="email_input"></p>
	<p>Password <input type="password" id="password_input"></p>
	<button type="button" id="login_button">Log in!</button>
	<script>
		document.getElementById("login_button").addEventListener('click', GetLoginInfo);
	</script>
</body>

</html>
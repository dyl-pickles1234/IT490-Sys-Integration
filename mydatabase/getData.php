<?php

$headers = [
	"Authorization: Bearer v^1.1#i^1#r^0#f^0#p^3#I^3#t^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"
];

$url = "https://api.ebay.com/buy/browse/v1/item_summary/search?q=9070xt&limit=1";

$ch = curl_init($url);
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

$apiResponse = curl_exec($ch);

curl_close($ch);

$data = json_decode($apiResponse, true);

$info = $data["itemSummaries"];


/*
foreach($data["itemSummaries"] as $info){
    $query = "insert gpu_info "
}
*/

function toDatabase($info){

    $id     = $info["itemId"];
    $name   = $info["title"];
    $price  = $info["price"]["value"];
    $url    = $info["itemWebUrl"];

    $mydb = new mysqli('127.0.0.1', 'testUser', '12345', 'proj_490');

    if ($mydb->errno != 0) {
        echo "failed to connect to database: " . $mydb->error . PHP_EOL;
        exit(0);
    }
    echo "successfully connected to database" . PHP_EOL;

    // add new entry
    $query = "insert into gpu_info (product_id, name, price, url) values ('$id', '$name', '$price', '$url');";

    $response = $mydb->query($query);
    if ($mydb->errno != 0) {
        echo "failed to execute query:" . PHP_EOL;
        echo __FILE__ . ':' . __LINE__ . ":error: " . $mydb->error . PHP_EOL;
        exit(0);
    }
    //var_dump($response);

    if ($response == true) {
        echo "yeah all good" . PHP_EOL;
    } else {
        echo "bad" . PHP_EOL;
        return false;
    }


}

?>
